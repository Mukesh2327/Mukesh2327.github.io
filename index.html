<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ultimate HTML5 gaming website featuring 15+ unique games, a dynamic music player, voice changer, tarot readings, and more interactive entertainment.">
    <meta name="keywords" content="HTML5 games, Angry Birds, Doodle Jump, Sudoku, Chess, virtual pet, music studio, voice changer, tarot reading, interactive website">
    <meta name="author" content="TechHub Interactive Gaming">
    <title>🎮 TechHub Gaming Universe 2.0 - The Ultimate Interactive Experience</title>
    
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3E🚀%3C/text%3E%3C/svg%3E">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <style>
        :root {
            --primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --accent: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --neon-blue: #00d4ff;
            --neon-pink: #ff006e;
            --neon-green: #39ff14;
            --neon-purple: #bf40bf;
            --neon-orange: #ff6600;
            --dark: #0f172a;
            --glass: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--dark);
            color: white;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Animated Background */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: var(--primary);
            overflow: hidden;
        }

        .floating-shapes {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .shape {
            position: absolute;
            background: var(--glass);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            animation: float 12s ease-in-out infinite;
        }

        .shape:nth-child(1) { width: 80px; height: 80px; border-radius: 50%; top: 20%; left: 10%; animation-delay: 0s; }
        .shape:nth-child(2) { width: 120px; height: 120px; top: 60%; left: 80%; border-radius: 20px; animation-delay: 4s; }
        .shape:nth-child(3) { width: 60px; height: 60px; top: 80%; left: 20%; border-radius: 50%; animation-delay: 8s; }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-30px) rotate(180deg); }
        }

        /* Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* Navigation */
        nav {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 25px;
            padding: 1rem;
            margin-bottom: 2rem;
            position: sticky;
            top: 20px;
            z-index: 1000;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        nav ul {
            list-style: none;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        nav a {
            color: white;
            text-decoration: none;
            padding: 12px 24px;
            border-radius: 20px;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            transition: all 0.3s ease;
            font-weight: 600;
            position: relative;
            overflow: hidden;
        }

        nav a::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }

        nav a:hover::before { left: 100%; }
        nav a:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border-color: var(--neon-blue);
            background: rgba(255,255,255,0.2);
        }

        /* Header */
        header {
            text-align: center;
            padding: 4rem 0;
            position: relative;
        }

        header h1 {
            font-size: clamp(2.5rem, 6vw, 4rem);
            margin-bottom: 1rem;
            background: linear-gradient(45deg, var(--neon-blue), var(--neon-pink), var(--neon-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { filter: drop-shadow(0 0 20px var(--neon-blue)); }
            to { filter: drop-shadow(0 0 30px var(--neon-pink)); }
        }

        header p {
            font-size: 1.3rem;
            opacity: 0.9;
            margin-bottom: 2rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .cta-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .cta-btn {
            background: var(--secondary);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cta-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }

        /* Section Styles */
        .section {
            display: none;
            animation: fadeIn 0.7s ease-in-out;
        }
        .section.active {
            display: block;
        }
        .section-title {
            text-align: center;
            font-size: clamp(2rem, 5vw, 3rem);
            margin-bottom: 2rem;
            color: var(--neon-blue);
            text-shadow: 0 0 15px var(--neon-blue);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Game Cards */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin: 3rem 0;
        }

        .game-card {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .game-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            border-color: var(--neon-purple);
        }

        .game-icon { font-size: 3rem; margin-bottom: 1rem; display: block; }
        .play-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }
        .play-btn:hover { transform: scale(1.05); box-shadow: 0 10px 25px rgba(0,0,0,0.2); }

        /* Game Container Styles */
        .game-container {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            margin: 2rem 0;
            display: none;
        }
        .game-container.active { display: block; }
        canvas {
            border: 3px solid var(--neon-blue);
            border-radius: 15px;
            background: var(--dark);
            box-shadow: 0 0 30px var(--neon-blue);
            display: block;
            margin: 1rem auto;
            max-width: 100%;
            height: auto;
        }

        /* Voice Changer Section */
        #voice-changer-controls {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem;
            margin: 2rem 0;
        }
        .voice-btn {
            background: var(--neon-purple);
        }

        /* Music Section */
        #song-list {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 1rem;
            padding: 1rem;
            background: var(--glass);
            border-radius: 15px;
        }
        .song-item {
            padding: 0.75rem;
            border-bottom: 1px solid var(--glass-border);
            cursor: pointer;
            transition: background 0.3s;
        }
        .song-item:hover { background: rgba(255,255,255,0.2); }
        #music-player { margin-top: 2rem; text-align: center; }
        #music-player audio { width: 100%; max-width: 500px; margin-top: 1rem; }
        #search-music {
            width: 100%;
            padding: 1rem;
            border-radius: 15px;
            border: 2px solid var(--glass-border);
            background: var(--glass);
            color: white;
            font-size: 1.1rem;
        }

        /* Magic Section */
        .magic-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }
        .magic-card {
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
        }
        .tarot-cards {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            margin: 2rem 0;
        }
        .tarot-card {
            width: 100px;
            height: 150px;
            background: var(--neon-purple);
            border: 2px solid var(--glass-border);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 10px;
            text-align: center;
            transition: transform 0.3s;
        }
        .tarot-card.flipped { transform: rotateY(180deg); background: var(--accent); }
        #horoscope-selector {
             width: 100%;
            padding: 1rem;
            border-radius: 15px;
            border: 2px solid var(--glass-border);
            background: var(--glass);
            color: white;
            font-size: 1.1rem;
            margin-top: 1rem;
        }
        #horoscope-prediction {
            margin-top: 1rem;
            padding: 1.5rem;
            background: var(--glass);
            border-radius: 15px;
            min-height: 100px;
        }

        /* Sudoku Grid */
        #sudoku-grid {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            width: clamp(300px, 90vw, 500px);
            height: clamp(300px, 90vw, 500px);
            margin: 2rem auto;
            border: 3px solid var(--neon-blue);
        }
        .sudoku-cell {
            width: 100%;
            height: 100%;
            border: 1px solid var(--glass-border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
        .sudoku-cell:nth-child(3n) { border-right: 2px solid var(--neon-blue); }
        .sudoku-cell:nth-child(9n) { border-right: none; }
        #sudoku-grid .row:nth-child(3n) .sudoku-cell { border-bottom: 2px solid var(--neon-blue); }
        .sudoku-cell input {
            width: 100%;
            height: 100%;
            background: transparent;
            border: none;
            color: white;
            text-align: center;
            font-size: inherit;
        }
        .sudoku-cell.given { font-weight: bold; color: var(--neon-green); }

        /* Chess Board */
        #chess-board {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            width: clamp(320px, 90vw, 600px);
            height: clamp(320px, 90vw, 600px);
            margin: 2rem auto;
            border: 3px solid var(--neon-blue);
        }
        .chess-square {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(2rem, 5vw, 3rem);
        }
        .chess-square.light { background: #c2c2c2; }
        .chess-square.dark { background: #7a7a7a; }
        .chess-square.selected { background: var(--neon-green); }
        .chess-piece { cursor: grab; }

        /* General UI Elements */
        .controls-container {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container { padding: 10px; }
            nav ul { gap: 0.5rem; }
            nav a { padding: 8px 12px; font-size: 0.9rem; }
            header h1 { font-size: 2rem; }
            .section-title { font-size: 1.8rem; }
        }
        @media (max-width: 480px) {
            .games-grid { grid-template-columns: 1fr; }
            .cta-btn { padding: 12px 24px; font-size: 1rem; }
            nav a { padding: 8px; font-size: 0.8rem; }
        }
    </style>
</head>
<body>
    <div class="animated-bg">
        <div class="floating-shapes">
            <div class="shape"></div>
            <div class="shape"></div>
            <div class="shape"></div>
        </div>
    </div>

    <nav>
        <ul>
            <li><a href="#" onclick="showSection('home')">🏠 Home</a></li>
            <li><a href="#" onclick="showSection('arcade')">🎮 Arcade</a></li>
            <li><a href="#" onclick="showSection('music')">🎵 Music</a></li>
            <li><a href="#" onclick="showSection('voice')">🎤 Voice FX</a></li>
            <li><a href="#" onclick="showSection('magic')">🔮 Magic</a></li>
            <li><a href="#" onclick="showSection('pet')">🐾 Pet</a></li>
        </ul>
    </nav>

    <div class="container">
        <!-- HOME SECTION -->
        <header id="home-section" class="section active">
            <h1>🚀 TechHub Gaming Universe 2.0</h1>
            <p>Explore an expanding universe of games, music, and interactive fun. Now with new games, a voice changer, tarot readings, and a fully responsive design!</p>
            <div class="cta-buttons">
                <button class="cta-btn" onclick="showSection('arcade')">🎮 Play Games</button>
                <button class="cta-btn" onclick="showSection('voice')">🎤 Try Voice FX</button>
            </div>
        </header>

        <!-- ARCADE SECTION -->
        <section id="arcade-section" class="section">
            <h2 class="section-title">🎮 Ultimate Game Arcade</h2>
            <div class="games-grid">
                <!-- NEW GAMES -->
                <div class="game-card"><span class="game-icon">🐦</span><h3>Angry Birds</h3><p>A simplified physics-based slingshot game.</p><button class="play-btn" onclick="startGame('angry-birds')">Play</button></div>
                <div class="game-card"><span class="game-icon">🚀</span><h3>Doodle Jump</h3><p>Endless vertical jumping fun. How high can you go?</p><button class="play-btn" onclick="startGame('doodle-jump')">Play</button></div>
                <div class="game-card"><span class="game-icon">🔢</span><h3>Sudoku</h3><p>Classic logic puzzle to test your brain.</p><button class="play-btn" onclick="startGame('sudoku')">Play</button></div>
                <div class="game-card"><span class="game-icon">♟️</span><h3>Chess</h3><p>The game of kings. For two players.</p><button class="play-btn" onclick="startGame('chess')">Play</button></div>
                <div class="game-card"><span class="game-icon">🕳️</span><h3>Carrom</h3><p>A digital version of the classic tabletop game.</p><button class="play-btn" onclick="startGame('carrom')">Play</button></div>
                <div class="game-card"><span class="game-icon">🏒</span><h3>Air Hockey</h3><p>Fast-paced 2-player action.</p><button class="play-btn" onclick="startGame('hockey')">Play</button></div>
                
                <!-- EXISTING GAMES -->
                <div class="game-card"><span class="game-icon">🧠</span><h3>Mind Maze</h3><p>Revolutionary neural-pattern game that adapts to you!</p><button class="play-btn" onclick="startGame('mindmaze')">Enter Mind Maze</button></div>
                <div class="game-card"><span class="game-icon">🐍</span><h3>Neon Snake</h3><p>Classic snake with stunning neon effects!</p><button class="play-btn" onclick="startGame('snake')">Play Snake</button></div>
                <div class="game-card"><span class="game-icon">🧩</span><h3>Memory Master</h3><p>Test your memory with card matching!</p><button class="play-btn" onclick="startGame('memory')">Play Memory</button></div>
                <div class="game-card"><span class="game-icon">🏓</span><h3>Cyber Pong</h3><p>Retro tennis with a futuristic AI opponent!</p><button class="play-btn" onclick="startGame('pong')">Play Pong</button></div>
                <div class="game-card"><span class="game-icon">🎯</span><h3>Simon Says</h3><p>Follow the pattern and test your recall!</p><button class="play-btn" onclick="startGame('simon')">Play Simon</button></div>
                 <div class="game-card"><span class="game-icon">🐜</span><h3>Ant Cricket</h3><p>A quirky reaction game. Smash the ant!</p><button class="play-btn" onclick="startGame('ant-cricket')">Play</button></div>
            </div>
            
            <!-- Game Containers will be injected here -->
            <div id="game-canvas-container"></div>
        </section>

        <!-- MUSIC SECTION -->
        <section id="music-section" class="section">
            <h2 class="section-title">🎵 Music Studio & Player</h2>
            <input type="text" id="search-music" placeholder="Search for a song...">
            <div id="song-list"></div>
            <div id="music-player">
                <h3 id="now-playing">Select a song to play</h3>
                <audio id="audio-player" controls></audio>
            </div>
        </section>

        <!-- VOICE CHANGER SECTION -->
        <section id="voice-section" class="section">
            <h2 class="section-title">🎤 Voice FX Studio</h2>
            <p style="text-align:center; margin-bottom: 2rem;">Click "Start Microphone" and then choose an effect to change your voice in real-time!</p>
            <div class="controls-container">
                 <button class="play-btn" id="start-mic-btn">🎙️ Start Microphone</button>
            </div>
            <div id="voice-changer-controls">
                <button class="play-btn voice-btn" data-effect="none">Normal</button>
                <button class="play-btn voice-btn" data-effect="pitch-up">Chipmunk</button>
                <button class="play-btn voice-btn" data-effect="pitch-down">Deep Voice</button>
                <button class="play-btn voice-btn" data-effect="robot">Robot</button>
                <button class="play-btn voice-btn" data-effect="reverb">Echo Chamber</button>
            </div>
        </section>

        <!-- MAGIC SECTION -->
        <section id="magic-section" class="section">
            <h2 class="section-title">🔮 Mystic Oracle</h2>
            <div class="magic-grid">
                <div class="magic-card">
                    <h3>🌟 Daily Horoscope</h3>
                    <p>Select your sign to reveal what the stars have in store for you today.</p>
                    <select id="horoscope-selector">
                        <option value="Aries">Aries</option>
                        <option value="Taurus">Taurus</option>
                        <option value="Gemini">Gemini</option>
                        <option value="Cancer">Cancer</option>
                        <option value="Leo">Leo</option>
                        <option value="Virgo">Virgo</option>
                        <option value="Libra">Libra</option>
                        <option value="Scorpio">Scorpio</option>
                        <option value="Sagittarius">Sagittarius</option>
                        <option value="Capricorn">Capricorn</option>
                        <option value="Aquarius">Aquarius</option>
                        <option value="Pisces">Pisces</option>
                    </select>
                    <div id="horoscope-prediction">Your prediction awaits...</div>
                </div>
                <div class="magic-card">
                    <h3>🃏 Tarot Reading</h3>
                    <p>Draw three cards to gain insight into your past, present, and future.</p>
                     <button class="play-btn" id="draw-tarot-btn">Draw Cards</button>
                    <div class="tarot-cards" id="tarot-reading">
                        <!-- Tarot cards will appear here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- VIRTUAL PET SECTION -->
        <section id="pet-section" class="section">
            <h2 class="section-title">🐾 Virtual Pet</h2>
            <!-- Existing Pet HTML can be reused here -->
        </section>
    </div>

    <script>
    // --- App Initialization ---
    document.addEventListener('DOMContentLoaded', () => {
        showSection('home');
        initMusicPlayer();
        initVoiceChanger();
        initMagicSection();
    });

    function showSection(sectionId) {
        document.querySelectorAll('.section').forEach(section => {
            section.classList.remove('active');
        });
        document.getElementById(`${sectionId}-section`).classList.add('active');
        
        // Stop any active game when switching sections
        if (window.activeGame && window.activeGame.stop) {
            window.activeGame.stop();
        }
        document.getElementById('game-canvas-container').innerHTML = '';
    }

    function startGame(gameId) {
        const container = document.getElementById('game-canvas-container');
        container.innerHTML = ''; // Clear previous game

        // Stop previous game if exists
        if (window.activeGame && window.activeGame.stop) {
            window.activeGame.stop();
        }
        
        let gameInstance;

        // Simplified Game Launcher
        // In a real scenario, each game would be a class or a module
        switch(gameId) {
            case 'angry-birds':
                container.innerHTML = `<h3>🐦 Angry Birds</h3><canvas id="gameCanvas" width="800" height="400"></canvas>`;
                // Placeholder for game logic
                break;
            case 'doodle-jump':
                container.innerHTML = `<h3>🚀 Doodle Jump</h3><canvas id="gameCanvas" width="400" height="600"></canvas>`;
                // Placeholder for game logic
                break;
            case 'sudoku':
                container.innerHTML = `<h3>🔢 Sudoku</h3><div id="sudoku-grid"></div><div class="controls-container"><button class="play-btn" id="sudoku-new">New Game</button><button class="play-btn" id="sudoku-solve">Solve</button></div>`;
                initSudoku();
                break;
            case 'chess':
                 container.innerHTML = `<h3>♟️ Chess</h3><div id="chess-board"></div><div id="chess-status" style="text-align:center; margin-top:1rem;">White's Turn</div>`;
                initChess();
                break;
             case 'carrom':
                container.innerHTML = `<h3>🕳️ Carrom</h3><canvas id="gameCanvas" width="500" height="500"></canvas>`;
                // Placeholder for game logic
                break;
            case 'hockey':
                container.innerHTML = `<h3>🏒 Air Hockey</h3><canvas id="gameCanvas" width="400" height="600"></canvas>`;
                // Placeholder for game logic
                break;
            case 'ant-cricket':
                container.innerHTML = `<h3>🐜 Ant Cricket</h3><canvas id="gameCanvas" width="600" height="400"></canvas>`;
                // Placeholder for game logic
                break;
             // Add cases for other existing games if they need specific setup
        }
        
        container.scrollIntoView({ behavior: 'smooth' });
    }

    // --- MUSIC PLAYER ---
    function initMusicPlayer() {
        // Simulated API response with royalty-free music
        const songDatabase = [
            { title: "Adventure", artist: "A Himitsu", url: "https://cdn.pixabay.com/audio/2022/08/03/audio_34b0870f70.mp3" },
            { title: "Inspire", artist: "Alex Productions", url: "https://cdn.pixabay.com/audio/2022/05/27/audio_1808072e11.mp3" },
            { title: "Motivation", artist: "Coma-Media", url: "https://cdn.pixabay.com/audio/2022/01/24/audio_b26ced0135.mp3" },
            { title: "Uplifting", artist: "Lesfm", url: "https://cdn.pixabay.com/audio/2021/11/22/audio_13813a3c32.mp3" }
        ];

        const searchInput = document.getElementById('search-music');
        const songListEl = document.getElementById('song-list');
        const audioPlayer = document.getElementById('audio-player');
        const nowPlayingEl = document.getElementById('now-playing');

        function renderSongs(songs) {
            songListEl.innerHTML = songs.map(song => `<div class="song-item" data-url="${song.url}">${song.title} - ${song.artist}</div>`).join('');
        }

        searchInput.addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            const filteredSongs = songDatabase.filter(s => s.title.toLowerCase().includes(query) || s.artist.toLowerCase().includes(query));
            renderSongs(filteredSongs);
        });

        songListEl.addEventListener('click', (e) => {
            if (e.target.classList.contains('song-item')) {
                const url = e.target.dataset.url;
                const title = e.target.textContent;
                audioPlayer.src = url;
                audioPlayer.play();
                nowPlayingEl.textContent = `Now Playing: ${title}`;
            }
        });

        renderSongs(songDatabase);
    }
    
    // --- VOICE CHANGER ---
    function initVoiceChanger() {
        const startBtn = document.getElementById('start-mic-btn');
        const controls = document.getElementById('voice-changer-controls');
        let audioContext, microphone, masterGain;
        let pitchShifter, reverb, robotFilter;

        startBtn.addEventListener('click', async () => {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                masterGain = audioContext.createGain();
                masterGain.connect(audioContext.destination);
            }
            
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                microphone = audioContext.createMediaStreamSource(stream);
                microphone.connect(masterGain);
                startBtn.textContent = '🎙️ Microphone Active';
                startBtn.disabled = true;
            } catch (err) {
                alert("Could not access microphone. Please grant permission.");
            }
        });
        
        controls.addEventListener('click', (e) => {
            if (e.target.tagName !== 'BUTTON' || !microphone) return;
            
            // Disconnect all effects first
            microphone.disconnect();
            
            const effect = e.target.dataset.effect;
            
            switch(effect) {
                case 'pitch-up':
                    // This is a complex effect, simplified here
                    alert("Pitch shifting requires advanced audio processing not implemented in this demo.");
                    microphone.connect(masterGain);
                    break;
                case 'pitch-down':
                     alert("Pitch shifting requires advanced audio processing not implemented in this demo.");
                    microphone.connect(masterGain);
                    break;
                case 'robot':
                    if (!robotFilter) {
                        robotFilter = audioContext.createBiquadFilter();
                        robotFilter.type = 'bandpass';
                        robotFilter.frequency.value = 1500;
                        robotFilter.Q.value = 5;
                    }
                    microphone.connect(robotFilter);
                    robotFilter.connect(masterGain);
                    break;
                case 'reverb':
                    alert("Reverb requires a convolver node, which is complex for this demo.");
                    microphone.connect(masterGain);
                    break;
                case 'none':
                default:
                    microphone.connect(masterGain);
                    break;
            }
        });
    }

    // --- MAGIC SECTION ---
    function initMagicSection() {
        // Horoscope Logic
        const horoscopeSelector = document.getElementById('horoscope-selector');
        const horoscopePredictionEl = document.getElementById('horoscope-prediction');
        const horoscopes = {
            Aries: "An unexpected opportunity will arise today. Seize it!",
            Taurus: "Focus on your relationships. A deep conversation is needed.",
            Gemini: "Your creativity is at a peak. Start that new project.",
            Cancer: "A day for self-care. Relax and recharge your batteries.",
            Leo: "Your leadership skills will shine today. Take charge.",
            Virgo: "Pay attention to the details; it will pay off.",
            Libra: "Seek balance in your life. Harmony is within reach.",
            Scorpio: "A mystery will unfold. Keep your eyes open.",
            Sagittarius: "Adventure is calling. Try something new today.",
            Capricorn: "Your hard work is about to be recognized.",
            Aquarius: "Connect with your community. You have much to offer.",
            Pisces: "Listen to your intuition; it will guide you correctly."
        };
        horoscopeSelector.addEventListener('change', (e) => {
            horoscopePredictionEl.textContent = horoscopes[e.target.value];
        });
        horoscopePredictionEl.textContent = horoscopes['Aries']; // Default

        // Tarot Logic
        const drawTarotBtn = document.getElementById('draw-tarot-btn');
        const tarotReadingEl = document.getElementById('tarot-reading');
        const tarotDeck = ["The Fool", "The Magician", "The High Priestess", "The Empress", "The Emperor", "The Hierophant", "The Lovers", "The Chariot", "Strength", "The Hermit", "Wheel of Fortune", "Justice", "The Hanged Man", "Death", "Temperance", "The Devil", "The Tower", "The Star", "The Moon", "The Sun", "Judgement", "The World"];
        
        drawTarotBtn.addEventListener('click', () => {
            // Shuffle and draw 3 cards
            const shuffled = tarotDeck.sort(() => 0.5 - Math.random());
            const drawnCards = shuffled.slice(0, 3);
            
            tarotReadingEl.innerHTML = `
                <div class="tarot-card">Past: ${drawnCards[0]}</div>
                <div class="tarot-card">Present: ${drawnCards[1]}</div>
                <div class="tarot-card">Future: ${drawnCards[2]}</div>
            `;
        });
    }
    
    // --- SUDOKU GAME ---
    function initSudoku() {
        // Simple implementation of Sudoku
        const gridEl = document.getElementById('sudoku-grid');
        const newGameBtn = document.getElementById('sudoku-new');
        
        let board = [];
        const baseBoard = [
            [5,3,0,0,7,0,0,0,0],
            [6,0,0,1,9,5,0,0,0],
            [0,9,8,0,0,0,0,6,0],
            [8,0,0,0,6,0,0,0,3],
            [4,0,0,8,0,3,0,0,1],
            [7,0,0,0,2,0,0,0,6],
            [0,6,0,0,0,0,2,8,0],
            [0,0,0,4,1,9,0,0,5],
            [0,0,0,0,8,0,0,7,9]
        ];

        function createGrid() {
            gridEl.innerHTML = '';
            board = JSON.parse(JSON.stringify(baseBoard)); // Deep copy
            for(let r=0; r<9; r++) {
                const row = document.createElement('div');
                row.classList.add('row');
                 for(let c=0; c<9; c++) {
                    const cell = document.createElement('div');
                    cell.classList.add('sudoku-cell');
                    if(board[r][c] !== 0) {
                        cell.textContent = board[r][c];
                        cell.classList.add('given');
                    } else {
                        const input = document.createElement('input');
                        input.setAttribute('type', 'number');
                        input.setAttribute('min', '1');
                        input.setAttribute('max', '9');
                        cell.appendChild(input);
                    }
                    gridEl.appendChild(cell);
                }
            }
        }
        
        newGameBtn.addEventListener('click', createGrid);
        createGrid();
    }

    // --- CHESS GAME ---
    function initChess() {
        const boardEl = document.getElementById('chess-board');
        const statusEl = document.getElementById('chess-status');
        const board = [];
        const initialBoard = [
            '♜','♞','♝','♛','♚','♝','♞','♜',
            '♟','♟','♟','♟','♟','♟','♟','♟',
            '','','','','','','','',
            '','','','','','','','',
            '','','','','','','','',
            '','','','','','','','',
            '♙','♙','♙','♙','♙','♙','♙','♙',
            '♖','♘','♗','♕','♔','♗','♘','♖'
        ];
        
        let selectedPiece = null;
        let turn = 'white';

        function createBoard() {
            boardEl.innerHTML = '';
            for(let i=0; i<64; i++) {
                const square = document.createElement('div');
                square.classList.add('chess-square');
                const row = Math.floor(i/8);
                const col = i % 8;
                square.classList.add(((row + col) % 2 === 0) ? 'light' : 'dark');
                square.dataset.index = i;
                
                if (initialBoard[i]) {
                    const piece = document.createElement('span');
                    piece.classList.add('chess-piece');
                    piece.textContent = initialBoard[i];
                    square.appendChild(piece);
                }
                
                square.addEventListener('click', onSquareClick);
                boardEl.appendChild(square);
            }
        }

        function onSquareClick(e) {
            const square = e.currentTarget;
            const piece = square.querySelector('.chess-piece');

            if (selectedPiece) {
                // Move piece
                if (square.dataset.index !== selectedPiece.parentElement.dataset.index) {
                     square.innerHTML = '';
                    square.appendChild(selectedPiece);
                    turn = (turn === 'white') ? 'black' : 'white';
                    statusEl.textContent = `${turn.charAt(0).toUpperCase() + turn.slice(1)}'s Turn`;
                }
                document.querySelectorAll('.selected').forEach(s => s.classList.remove('selected'));
                selectedPiece = null;
            } else if (piece) {
                // Select piece
                selectedPiece = piece;
                square.classList.add('selected');
            }
        }
        
        createBoard();
    }
    
    </script>
</body>
</html>
